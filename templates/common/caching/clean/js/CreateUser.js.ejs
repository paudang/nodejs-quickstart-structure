const User = require('../domain/models/User');
<%_ if (caching === 'Redis') { -%>
const cacheService = require('../infrastructure/caching/redisClient');
<%_ } else if (caching === 'Memory Cache') { -%>
const cacheService = require('../infrastructure/caching/memoryCache');
<%_ } -%>
const logger = require('../infrastructure/log/logger');

class CreateUser {
    constructor(userRepository) {
        this.userRepository = userRepository;
    }

    async execute(name, email) {
        const user = new User(null, name, email);
        const savedUser = await this.userRepository.save(user);

        try {
            await cacheService.del('users:all');
            logger.info('Invalidated users:all cache');
        } catch (error) {
            logger.error('Cache error (del):', error);
        }

        return savedUser;
    }
}

module.exports = CreateUser;
