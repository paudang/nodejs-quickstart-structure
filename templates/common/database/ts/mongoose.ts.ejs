import mongoose from 'mongoose';
<% if (architecture === 'MVC') { %>
import logger from '@/utils/logger';
<% } else { %>
import logger from '@/infrastructure/log/logger';
<% } %>
const connectDB = async (): Promise<void> => {
    const dbHost = process.env.DB_HOST || 'localhost';
    const mongoURI = process.env.MONGO_URI || `mongodb://${dbHost}:27017/<%= dbName %>`;
    
    let retries = 5;
    while (retries) {
        try {
            await mongoose.connect(mongoURI);
            logger.info('MongoDB Connected...');
            break;
        } catch (err) {
            logger.error('MongoDB connection failed:', err);
            retries -= 1;
            logger.info(`Retries left: ${retries}. Waiting 5s...`);
            await new Promise(res => setTimeout(res, 5000));
        }
    }
};

export default connectDB;
